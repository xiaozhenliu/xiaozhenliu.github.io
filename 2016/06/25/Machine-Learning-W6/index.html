
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Machine Learning By Stanford University Week 6 | Live in the Future, then Build What&#39;s Missing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Liu Xiaozhen">
    

    
    <meta name="description" content="6. Machine Learning Application Advice and System Design&amp;#x672C;&amp;#x5468;&amp;#x8BFE;&amp;#x7A0B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x673A;&amp;#x5668;&amp;#x5B66;&amp;#x4E60;&amp;#x5E94;&amp;#x7528;&amp;#x4E2D;&amp;#x7684;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;">
<meta property="og:type" content="article">
<meta property="og:title" content="Machine Learning By Stanford University Week 6">
<meta property="og:url" content="http://tech.liuxiaozhen.com/2016/06/25/Machine-Learning-W6/index.html">
<meta property="og:site_name" content="Live in the Future, then Build What's Missing">
<meta property="og:description" content="6. Machine Learning Application Advice and System Design&amp;#x672C;&amp;#x5468;&amp;#x8BFE;&amp;#x7A0B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x673A;&amp;#x5668;&amp;#x5B66;&amp;#x4E60;&amp;#x5E94;&amp;#x7528;&amp;#x4E2D;&amp;#x7684;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-01.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-02.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-03.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-04.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-05.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-06.png">
<meta property="og:image" content="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-06.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Machine Learning By Stanford University Week 6">
<meta name="twitter:description" content="6. Machine Learning Application Advice and System Design&amp;#x672C;&amp;#x5468;&amp;#x8BFE;&amp;#x7A0B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x673A;&amp;#x5668;&amp;#x5B66;&amp;#x4E60;&amp;#x5E94;&amp;#x7528;&amp;#x4E2D;&amp;#x7684;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;">
<meta name="twitter:creator" content="@xiaozhenliu">
<link rel="publisher" href="110358754558341446765">

    
    <link rel="alternative" href="/atom.xml" title="Live in the Future, then Build What&#39;s Missing" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Live in the Future, then Build What&#39;s Missing" title="Live in the Future, then Build What&#39;s Missing"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Live in the Future, then Build What&#39;s Missing">Live in the Future, then Build What&#39;s Missing</a></h1>
				<h2 class="blog-motto">刘虓震的技术笔记</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Homepage | 首页</a></li>
					
						<li><a href="/http://liuxiaozhen.com">Blog | 博客</a></li>
					
						<li><a href="/archive">Archives | 归档</a></li>
					
						<li><a href="/about">About | 关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:tech.liuxiaozhen.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/06/25/Machine-Learning-W6/" title="Machine Learning By Stanford University Week 6" itemprop="url">Machine Learning By Stanford University Week 6</a>
  </h1>
  <p class="article-author">By
       
		<a href="https://plus.google.com/110358754558341446765?rel=author" title="Liu Xiaozhen" target="_blank" itemprop="author">Liu Xiaozhen</a>
		
  <p class="article-time">
    <time datetime="2016-06-25T14:24:12.000Z" itemprop="datePublished"> 发表于 2016-06-25</time>
    
  </p>
</header>
	<div class="article-content">
		
		<h1 id="6-_Machine_Learning_Application_Advice_and_System_Design">6. Machine Learning Application Advice and System Design</h1><p>&#x672C;&#x5468;&#x8BFE;&#x7A0B;&#x4ECB;&#x7ECD;&#x4E86;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x5E94;&#x7528;&#x4E2D;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x4EE5;&#x53CA;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x3002;</p>
<a id="more"></a>
<p><strong>This note is for the Stanford University online course &#x201C;Machine Learning&#x201D; taught by Andrew Ng on Coursera.org, 2016 May session.</strong></p>
<h2 id="6-1_Evaluating_a_Learning_Algorithm">6.1 Evaluating a Learning Algorithm</h2><p>Goal: Learn How to choose one of the most promising avenues to spend your time pursuing. </p>
<h3 id="6-1-1_Deciding_what_to_try_next">6.1.1 Deciding what to try next</h3><p><strong>Debugging a learning algorithm</strong></p>
<p>Suppose you have implemented regularized linear regression to predict housing prices. </p>
<p>However, when you test your hypothesis on a new set of hourses, you find that it makes unacceptably large errors in its predictions. What should you try next?</p>
<ul>
<li>Get more training examples</li>
<li>Try smaller sets of features </li>
<li>Try getting additional features</li>
<li>Try adding polynomial features $(x_1^2, x_2^2, x_1x_2, \text{etc})$</li>
<li>Try decreasing $\lambda$</li>
<li>Try increasing $\lambda$  </li>
</ul>
<p>WRONG: Randomly pick one of these options</p>
<p>CORRECT: Machine Learning Diagnostic</p>
<p>A test that you can run to gain insight what is/isn&#x2019;t working with a learning algorithm, and gain guidance as to how best to improve its performance. </p>
<h3 id="6-1-2_Evaluating_a_Hypothesis">6.1.2 Evaluating a Hypothesis</h3><p>Example: Using housing sizes to predict prices.</p>
<p>Method: (randomly) choose 70% of the dataset (samples) as the training set, the other 30% as the test set. </p>
<p>Training set: $m$ number of samples; $x^{(1)},y^{(1)}&#x2026;x^{(m)},y^{(m)}$</p>
<p>Test set: $m_test$ number of samples<br>$x_{test}^{(1)},y_{test}^{(1)}&#x2026;x_{test}^{(m)},y_{text}^{(m)}$</p>
<p><strong>Training/testing procedure for linear regression</strong></p>
<ul>
<li>Learn parameter $\theta$ from training data (minimizing training error $J(\theta)$)</li>
<li>Compute test set error: </li>
</ul>
<p>$$J_{test}(\theta)=\frac1{2m_{test}}\sum_{i=1}^{m_{test}}\left(h_\theta(x_{test}^{(i)})-y_{test}^{(i)}\right)^2$$</p>
<p>$$J_{test}(\theta)=\frac1{2m_{test}}\sum_{i=1}^{m_{test}}y_{test}^{(i)}\log h_\theta(x_{test}^{(i)})+(1-y_{test}^{(i)})\log h_\theta(x_{test}^{(i)})$$</p>
<ul>
<li>Misclassification error (0/1 misclassification error);</li>
</ul>
<p>$$err(h_\theta(x),y)=\begin{cases}1\quad\text{if }h_\theta(x)\geq0.5, y=0\text{ or if } h_\theta(x)\leq0.5, y=1\0\quad\text{otherwise}\end{cases}$$</p>
<p>$$\text{Test error} = \frac1{m_{test}}\sum_{i=1}^{m_{test}}err\left(h_\theta(x_{test}^{(i)}),y_{test}^{(i)}\right)\<br>$$</p>
<h3 id="6-1-3_Model_Selection_and_Train/Validation/Test_Sets">6.1.3 Model Selection and Train/Validation/Test Sets</h3><p><strong>Overfitting example</strong></p>
<p>Once parameters $\theta_0,\theta_1,&#x2026;,\theta_4$ were fit to some set of data (traning set), the error of the parameters as measured on that data (the traing error $J(\theta)$) is likely to be lower than the actual generalization error.</p>
<p><strong>Model selection</strong></p>
<ol>
<li>$h_\theta(x) = \theta_0+\theta_1x$</li>
<li>$h_\theta(x) = \theta_0+\theta_1x+\theta_2x^2$</li>
<li>$h_\theta(x) = \theta_0+\theta_1x+&#x2026;+\theta_3x^2$<br>&#x2026;</li>
<li>$h_\theta(x) = \theta_0+\theta_1x+&#x2026;+\theta_10x^10$</li>
</ol>
<p>Assume a new parameter $d$ = degree of polynomial. </p>
<p>Test dataset cost functions: $J_{test}(\theta_j)$ ($j$ is from 1 to $d$)</p>
<p>Problem: degree of polynomial is chosen based on the test dataset, therefore cannot guarantee the generalization ability to further data. </p>
<p><strong>Solution</strong>: divide the original dataset to a training set, a cross validation set (CV), and a test set. </p>
<p><strong>Train/validation/test error</strong></p>
<p>Use the CV set to select the model. Then estimate generalization error $J_{test}(\theta)$</p>
<h2 id="6-2_Bias_vs-_Variance">6.2 Bias vs. Variance</h2><h3 id="6-2-1_Diagnosing_Bias_vs-_Variance">6.2.1 Diagnosing Bias vs. Variance</h3><p>High bias - Underfit<br>High variance - Overfit</p>
<p>Training error: </p>
<p>$$J_{train}(\theta)=\frac1{2m}\sum_{i=1}^m\left(h_\theta(x^{(i)})-y^{(i)}\right)^2$$</p>
<p>Cross validation error:<br>$$J_{cv}(\theta)=\frac1{2m_{cv}}\sum_{i=1}^{m_{cv}}\left(h_\theta(x_{cv}^{(i)})-y_{cv}^{(i)}\right)^2$$</p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-01.png" alt=""></p>
<h3 id="6-2-2_Regularization_and_Bias/Variance">6.2.2 Regularization and Bias/Variance</h3><p><strong>Linear regression with regularization</strong></p>
<p>Large $\lambda$: high bias, underfit</p>
<p>Small $\lambda$: high variance, overfit</p>
<p><strong>Choosing the regularization parameter $\lambda$</strong></p>
<ul>
<li><p>have some range of $\lambda$ values: e.g. [0,0.01,0.02,0.04,0.08&#x2026;10]</p>
</li>
<li><p>calculate $\min J(\theta)$ for each $\lambda$ -&gt; $J_{cv}(\theta^{(?)})$</p>
</li>
<li><p>pick the lowest $J_{cv}(\theta^{(?)})$ $\theta^{(5)}$. Test error: $J_{test}(\theta^{(5)})$</p>
</li>
<li><p>Plot $J_{train}(\theta)$ and $J_{cv}(\theta)$ v.s. $\lambda$</p>
</li>
</ul>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-02.png" alt=""></p>
<h3 id="6-2-3_Learning_Curves">6.2.3 Learning Curves</h3><p>&#x589E;&#x52A0;&#x6837;&#x672C;&#x6570;&#x662F;&#x5426;&#x80FD;&#x51CF;&#x5C11;&#x8BEF;&#x5DEE;&#xFF1F;</p>
<p>Learning curves: plot error v.s. m (training set size)</p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-03.png" alt=""></p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-04.png" alt=""></p>
<p>High bias:</p>
<p>If a learning algorithm is suffering from high bias, getting more training data will not (by itself) help much.</p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-05.png" alt=""></p>
<p>High variance:</p>
<p>If a learning algorithm is suffering from high variance, getting more traning data is likely to help.</p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-06.png" alt=""></p>
<h3 id="6-2-4_Deciding_What_to_Do_Next_Revisited">6.2.4 Deciding What to Do Next Revisited</h3><p><strong>Debugging a learning algorithm</strong></p>
<p>Suppose you have implemented regularized linear regression to predict housing prices. </p>
<p>However, when you test your hypothesis on a new set of hourses, you find that it makes unacceptably large errors in its predictions. What should you try next?</p>
<ul>
<li>Get more training examples -&gt; _fixes high variance_</li>
<li>Try smaller sets of features -&gt; _fixes high variance_</li>
<li>Try getting additional features -&gt; _fixes high bias_</li>
<li>Try adding polynomial features $(x_1^2, x_2^2, x_1x_2, \text{etc})$ -&gt; _fixes high bias_</li>
<li>Try decreasing $\lambda$ -&gt; _fixes high bias_</li>
<li>Try increasing $\lambda$ -&gt; _fixes high variance_</li>
</ul>
<p><strong>Neural networks and overfitting</strong></p>
<p><img src="/2016/06/25/Machine-Learning-W6/Coursera-ml-w6-06.png" alt=""></p>
<p>Using a single hidden layer is a reasonable default. But if you want to choose the number of hidden layers, one other thing you can try is find yourself a training cross-validation, and test set split and try training neural networks with one hidden layer or two hidden layers or three hidden layers and see which of those neural networks performs best on the cross-validation sets. </p>
<h2 id="6-3_Building_a_Spam_Classifier">6.3 Building a Spam Classifier</h2><h3 id="6-3-1_Prioritizing_What_to_Work_on">6.3.1 Prioritizing What to Work on</h3><h3 id="6-3-2_Error_Analysis">6.3.2 Error Analysis</h3><h2 id="6-4_Handling_Skewed_Data">6.4 Handling Skewed Data</h2><p>Cancer classification example<br>1% error on test set (99% correct)</p>
<h3 id="Error_Metrics_for_Skewed_Classes">Error Metrics for Skewed Classes</h3><h3 id="Trading_Off_Precision_and_Recall">Trading Off Precision and Recall</h3><p>Logistic regression:<br>Predict 1 if<br>Predict 0 if<br>Suppose we want to predict y = 1 only if very confident</p>
<p>-&gt; Higher precision, lower recall.</p>
<p>Suppose we want to avoid missing too many cases of cancer (avoid false negatives).</p>
<p>-&gt; higher recall, lower precision</p>
<p><strong>$F_1$ Score (F score)</strong></p>
<p>How to compare precision/recall numbers?</p>
<p>The average of P and R is not a good indicator</p>
<p>$F_1$ score: $2\frac{PR}{P+R}$</p>
<h2 id="6-5_Using_Large_Data_Sets">6.5 Using Large Data Sets</h2><h3 id="Designing_a_high_accuracy_learning_system">Designing a high accuracy learning system</h3><p>e.g. Classify between confusable words. {to,two,too},{then,than}</p>
<p>Algorithms:</p>
<ul>
<li>Perceptron (Logistic regression)</li>
<li>Winnow</li>
<li>Memory-based</li>
<li>Naive Bayes</li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Coursera/">Coursera</a><a href="/tags/Learning-Curves/">Learning Curves</a><a href="/tags/Machine-Learning/">Machine Learning</a><a href="/tags/Model-Selection/">Model Selection</a><a href="/tags/Overfitting/">Overfitting</a><a href="/tags/Precision/">Precision</a><a href="/tags/Recall/">Recall</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://tech.liuxiaozhen.com/2016/06/25/Machine-Learning-W6/" data-title="Machine Learning By Stanford University Week 6 | Live in the Future, then Build What&#39;s Missing" data-tsina="hohcn" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2016/06/12/Machine-Learning-W5/"  title="Machine Learning By Stanford University Week 5">
 <strong>下一篇：</strong><br/> 
 <span>Machine Learning By Stanford University Week 5
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2016/06/25/Machine-Learning-W6/" data-title="Machine Learning By Stanford University Week 6" data-url="http://tech.liuxiaozhen.com/2016/06/25/Machine-Learning-W6/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Coursera/" title="Coursera">Coursera<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Machine-Learning/" title="Machine Learning">Machine Learning<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Linear-Regression/" title="Linear Regression">Linear Regression<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Precision/" title="Precision">Precision<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Udacity/" title="Udacity">Udacity<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Statistics/" title="Statistics">Statistics<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Nanodegree/" title="Nanodegree">Nanodegree<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Learning-Curves/" title="Learning Curves">Learning Curves<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Model-Selection/" title="Model Selection">Model Selection<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Overfitting/" title="Overfitting">Overfitting<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Data-Analyst/" title="Data Analyst">Data Analyst<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Recall/" title="Recall">Recall<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Neural-Networks/" title="Neural Networks">Neural Networks<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Logistic-Regression/" title="Logistic Regression">Logistic Regression<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Regularization/" title="Regularization">Regularization<sup>1</sup></a></li>
			
		
			
		
			
		
			
		
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  

<div class="doubanshow">
<p class="asidetitle">豆瓣秀</p>
<div>
<script type="text/javascript" src="http://www.douban.com/service/badge/67534041/?show=collection&amp;n=12&amp;columns=3&amp;hidelogo=yes&amp;hideself=yes&amp;cat=book|movie" ></script>
</div>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Never doubt that a small group of thoughtful, committed citizens can change the world; <br/>
			indeed, it&#39;s the only thing that ever has.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/hohcn" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/xiaozhenliu" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/xiaozhenliu" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		
		<a href="https://www.linkedin.com/in/xiaozhenliu" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		<a href="https://www.douban.com/people/67534041" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		<a href="http://www.zhihu.com/people/xiaozhenliu" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		<a href="https://plus.google.com/110358754558341446765?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:zjuhoh@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		
				<div class="cc-license">
          <a href="http://creativecommons.org/licenses/by-nc/4.0" class="cc-opacity" target="_blank">
            <img src="/img/cc-by-nc.svg" alt="Creative Commons" />
          </a>
        </div>
    

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Liu Xiaozhen">Liu Xiaozhen</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"techlxz## e.g. wuchong   your duoshuo short name."};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-61561823-1', 'tech.liuxiaozhen.com');  
ga('send', 'pageview');
</script>





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  
<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config(null);
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
</body>
</html>
